# ğŸŒ SMS-Bridge (çŸ­ä¿¡é€š)

---

> **æŠŠå‡ åå—é’±çš„ USB ä¸Šç½‘å¡æ’åˆ°ç©å®¢äº‘ / æ ‘è“æ´¾ / ä»»æ„ Linux è®¾å¤‡ï¼Œè®©å®ƒå˜æˆä¸€å°â€œäº‘æ‰‹æœºâ€ã€‚è‡ªåŠ¨æ”¶çŸ­ä¿¡ã€è½¬å‘çŸ­ä¿¡ã€ç½‘é¡µå‘çŸ­ä¿¡ä¿å·ã€‚**

---

## ğŸš€ é¡¹ç›®ç®€ä»‹

**SMS-Bridgeï¼ˆçŸ­ä¿¡é€šï¼‰** æ˜¯ä¸€ä¸ªè½»é‡çº§çš„â€œäº‘æ‰‹æœºâ€æ–¹æ¡ˆï¼š

- ä½¿ç”¨äºŒæ‰‹ USB 4G ä¸Šç½‘å¡ï¼ˆ10â€“20 å…ƒï¼‰ã€‚

- æ’å…¥ä»»æ„ SIM å¡ï¼ˆGiffgaff / Helium / ä¸­å›½ç§»åŠ¨ä¿å·å¡çš†å¯ï¼‰ã€‚

- åˆ©ç”¨ Python + AT æŒ‡ä»¤è¯»å–çŸ­ä¿¡å¹¶è½¬å‘ã€‚

- æä¾›ç°ä»£åŒ– Web UIï¼Œå¯åœ¨çº¿å‘é€çŸ­ä¿¡ä¿å·ã€‚

- æ”¯æŒ Docker / systemd éƒ¨ç½²ï¼Œé€‚é…ç©å®¢äº‘ã€æ ‘è“æ´¾ç­‰è®¾å¤‡ã€‚

**æ ¸å¿ƒç›®æ ‡ï¼š** ä¸å†éœ€è¦å¤‡ç”¨æœºï¼Œä¸éœ€è¦ç»™æ‰‹æœºä¸€ç›´æ’ç€ SIM å¡ã€‚  
ç›´æ¥åœ¨ç”µè„‘ / æœåŠ¡å™¨ / Telegram é‡Œæ”¶çŸ­ä¿¡ï¼

---

## âœ¨ åŠŸèƒ½äº®ç‚¹

- ğŸ“¥ **çŸ­ä¿¡è‡ªåŠ¨æ¥æ”¶**ï¼šé€šè¿‡ USB 4G Dongle è¯»å– SIM å¡çŸ­ä¿¡ã€‚

- ğŸ“¤ **è‡ªåŠ¨è½¬å‘**ï¼š
  
  - Telegram Bot
  
  - PushPlusï¼ˆè½¬å‘åˆ°å¾®ä¿¡ï¼‰

- ğŸ“Ÿ **Web æ§åˆ¶é¢æ¿**ï¼š

  - æŸ¥çœ‹æ‰€æœ‰çŸ­ä¿¡

  - åœ¨çº¿å‘é€çŸ­ä¿¡ï¼ˆä¿å·ï¼‰

  - ä¸€é”®å¯åŠ¨ / åœæ­¢ç›‘å¬

  - æŸ¥çœ‹å®æ—¶è¿è¡ŒçŠ¶æ€ä¸æœ€è¿‘è½®è¯¢æ—¶é—´

- ğŸ’¾ **SQLite æŒä¹…åŒ–**ï¼šæ‰€æœ‰çŸ­ä¿¡ä¿å­˜åˆ°æœ¬åœ°æ•°æ®åº“ã€‚

- ğŸ³ **Docker æ”¯æŒ**ï¼šå¼€ç®±å³ç”¨ï¼Œé€‚é…ç©å®¢äº‘ã€‚

- ğŸ”§ **systemd æ”¯æŒ**ï¼šé€‚åˆç›´æ¥è·‘åœ¨ Linux ä¸»æœºã€‚

- ğŸ” **å¢å¼ºå‹ Modem è§£æ**ï¼šå…¼å®¹æ›´å¤šå‹å· USB ä¸Šç½‘å¡ï¼Œç¨³å®šè§£æ AT çŸ­ä¿¡ã€‚

- ğŸ”’ **å¯é€‰ Basic è®¤è¯**ï¼šä¸º Web UI ä¸ API åŠ ä¸Šç”¨æˆ·å / å¯†ç ï¼Œé¿å…å…¬ç½‘æš´éœ²è¢«æ»¥ç”¨ã€‚

- âš¡ **å¼‚æ­¥è½¬å‘ä¸è¶…æ—¶æ§åˆ¶**ï¼šè¿œç¨‹æ¨é€åœ¨åå°çº¿ç¨‹æ‰§è¡Œï¼Œå¹¶å¯¹å¤–éƒ¨è¯·æ±‚è®¾ç½®è¶…æ—¶ï¼Œé¿å…é˜»å¡çŸ­ä¿¡é‡‡é›†ã€‚

---

## ğŸ“‚ ä»“åº“ç»“æ„

```
SMS-Bridge/
â”œâ”€ README.md
â”œâ”€ LICENSE
â”œâ”€ requirements.txt
â”œâ”€ Dockerfile
â”œâ”€ docker-compose.yml
â”œâ”€ config.example.yaml
â”œâ”€ app/
â”‚  â”œâ”€ config.py
â”‚  â”œâ”€ db.py
â”‚  â”œâ”€ modem.py
â”‚  â”œâ”€ forwarder.py
â”‚  â”œâ”€ worker.py
â”‚  â”œâ”€ keepalive.py
â”‚  â”œâ”€ web.py
â”‚  â””â”€ templates/index.html
â””â”€ scripts/
   â””â”€ install_systemd.sh
```

---

## âš¡ å¿«é€Ÿå¼€å§‹

### 1. æ’ä¸Š USB ä¸Šç½‘å¡

è·å–è®¾å¤‡åç§°ï¼š

```bash
dmesg | grep tty
```

å¸¸è§ï¼š`/dev/ttyUSB0` æˆ– `/dev/ttyACM0`

### 2. é…ç½®æ–‡ä»¶

å¤åˆ¶ï¼š

```bash
cp config.example.yaml config.yaml
```

å¡«å…¥ä¸²å£ã€Telegram tokenã€æ¨é€é…ç½®ç­‰ã€‚

> **å®‰å…¨æç¤º**ï¼šå¦‚éœ€åœ¨å…¬ç½‘è®¿é—®ï¼Œå»ºè®®åœ¨ `http.auth_user` / `http.auth_password` ä¸­è®¾ç½®ç”¨æˆ·åå’Œå¯†ç ï¼Œå¯ç”¨ HTTP Basic è®¤è¯ã€‚

### 2.1 é…ç½®å­—æ®µé€ŸæŸ¥

| é…ç½®é¡¹ | ä½œç”¨ |
| --- | --- |
| `serial_port` / `baudrate` | ä¸²å£è®¾å¤‡ä¸æ³¢ç‰¹ç‡ã€‚ |
| `poll_interval` | è½®è¯¢æœªè¯»çŸ­ä¿¡çš„é—´éš”ç§’æ•°ã€‚ |
| `telegram.*` | Telegram Bot è½¬å‘ç›¸å…³çš„å¼€å…³ã€tokenã€chat_idã€‚ |
| `wechat_pushplus.*` | PushPlusï¼ˆå¾®ä¿¡ï¼‰è½¬å‘çš„å¼€å…³ä¸ tokenã€‚ |
| `keepalive.*` | æ˜¯å¦å¯ç”¨ä¿å·çŸ­ä¿¡ã€ç›®æ ‡å·ç ä¸å†…å®¹ã€‚ |
| `database` | SQLite æ•°æ®åº“å­˜æ”¾è·¯å¾„ã€‚ |
| `http.host` / `http.port` | Web æœåŠ¡ç›‘å¬åœ°å€ä¸ç«¯å£ã€‚ |
| `http.auth_user` / `http.auth_password` | å¯ç”¨ HTTP Basic è®¤è¯çš„ç”¨æˆ·å/å¯†ç ï¼ˆå¯é€‰ï¼Œä½†å…¬ç½‘å»ºè®®å¼€å¯ï¼‰ã€‚ |
| `request_timeout` | å¤–éƒ¨è½¬å‘è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œé˜²æ­¢é˜»å¡ã€‚ |
| `forwarder_workers` | å¼‚æ­¥è½¬å‘çº¿ç¨‹æ± å¤§å°ï¼Œå¯æ ¹æ®å¹¶å‘é‡è°ƒæ•´ã€‚ |

### 3. Docker æ–¹å¼è¿è¡Œï¼ˆæ¨èç©å®¢äº‘ï¼‰

```bash
docker build -t sms-bridge .
docker run \
  --device=/dev/ttyUSB0:/dev/ttyUSB0 \
  -p 8080:8080 \
  -v $(pwd)/data:/data \
  sms-bridge
```

è®¿é—®ï¼š`http://è®¾å¤‡IP:8080`

### 4. ç›´æ¥è¿è¡Œï¼ˆæ—  Dockerï¼‰

```bash
pip install -r requirements.txt
python app/web.py
```

---

## ğŸ–¥ï¸ Web UI é¢„è§ˆ

- å·¦ä¾§ï¼šçŸ­ä¿¡è®°å½•ï¼ˆå¸¦æ–¹å‘åŒºåˆ†ï¼‰

- å³ä¾§ï¼šå‘é€çŸ­ä¿¡ã€ä¿å·æŒ‰é’®

- é¡¶éƒ¨ï¼šå¯åŠ¨ / åœæ­¢ç›‘å¬

- è‡ªåŠ¨åˆ·æ–°æœ€æ–°çŸ­ä¿¡

å‰ç«¯å·²ä½¿ç”¨è½»é‡ç°ä»£é£æ ¼ç¾åŒ–ã€‚

---

## âœ… åŠŸèƒ½ä¸è¿è¡ŒçŠ¶æ€

- Web è·¯ç”±ï¼šæ ¹é¡µé¢ã€å¯åŠ¨/åœæ­¢ã€ä¿å·ã€å‘é€çŸ­ä¿¡ã€`/_messages_json` è½®è¯¢æ¥å£å‡å·²æä¾›ï¼Œå‰ç«¯ä¸ä¼šå†å› ç¼ºå°‘æ¥å£æŠ¥ 404ã€‚
- è½¬å‘ï¼šTelegram ä¸ PushPlus è¯·æ±‚å…·å¤‡è¶…æ—¶ä¿æŠ¤ï¼Œå¹¶é€šè¿‡åå°çº¿ç¨‹å¼‚æ­¥æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡çŸ­ä¿¡é‡‡é›†çº¿ç¨‹ã€‚
- å®‰å…¨ï¼šé…ç½®äº† `http.auth_user` / `http.auth_password` æ—¶ï¼Œæ‰€æœ‰ UI ä¸ API éƒ½éœ€ Basic è®¤è¯ï¼Œå¯åœ¨å…¬ç½‘å®‰å…¨è®¿é—®ã€‚
- çŠ¶æ€ï¼šæ–°å¢ `/status` è·¯ç”±ï¼Œè¿”å›ç›‘å¬æ˜¯å¦è¿è¡Œã€è½®è¯¢é—´éš”ä¸æœ€è¿‘æ‹‰å–æ—¶é—´ï¼Œå‰ç«¯è‡ªåŠ¨æ˜¾ç¤ºã€‚
- æ•°æ®ï¼šçŸ­ä¿¡æŒä¹…åŒ–åˆ° SQLiteï¼Œå‰ç«¯è½®è¯¢ä¼šè‡ªåŠ¨æ˜¾ç¤ºæœ€æ–°è®°å½•ã€‚

---

## ğŸ”§ é«˜çº§åŠŸèƒ½

### ğŸŒ Telegram è½¬å‘

æ”¶åˆ°çŸ­ä¿¡åè‡ªåŠ¨å‘é€åˆ°ä½ çš„ Telegram æœºå™¨äººï¼š

```yaml
telegram:
  enabled: true
  bot_token: "xxxx"
  chat_id: "123456"
```

### ğŸ“¡ å¾®ä¿¡ï¼ˆPushPlusï¼‰è½¬å‘

```yaml
wechat_pushplus:
  enabled: true
  token: "xxxx"
```

### ğŸ”„ ä¸€é”®ä¿å·

ç‚¹å‡»ç½‘é¡µæŒ‰é’®å³å¯å‘ä¸€æ¡çŸ­ä¿¡å®Œæˆè¿è¥å•†â€œä¿å·ä»»åŠ¡â€ã€‚

### ğŸ§  Modem è§£æå¢å¼º

- å¤šè®¾å¤‡å…¼å®¹

- æ›´ robust çš„ AT è¾“å‡ºè§£æ

- æ”¯æŒä¸è§„èŒƒæ¢è¡Œã€ä¸åŒå‚å•†æ ¼å¼

- é¿å…æ¼æ‰çŸ­ä¿¡

---

## ğŸ³ docker-compose ç¤ºä¾‹

```yaml
version: '3.8'
services:
  smsbridge:
    build: .
    devices:
      - "/dev/ttyUSB0:/dev/ttyUSB0"
    ports:
      - "8080:8080"
    volumes:
      - ./data:/data
    restart: unless-stopped
```

---

## ğŸ“ License

[MIT](/LICENSE)

---
